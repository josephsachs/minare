{
  "config": {
    "target": "http://localhost:8080",
    "phases": [
      {
        "duration": 60,
        "arrivalRate": 1,
        "name": "Warm up - Establish initial connections"
      },
      {
        "duration": 300,
        "arrivalRate": 3,
        "rampTo": 10,
        "name": "Ramp up - Gradually increase load"
      },
      {
        "duration": 600,
        "arrivalRate": 10,
        "maxVusers": 30,
        "name": "Main test - Sustained mixed user types"
      },
      {
        "duration": 300,
        "arrivalRate": 10,
        "rampTo": 1,
        "name": "Ramp down - Gradually decrease load"
      },
      {
        "duration": 60,
        "arrivalRate": 1,
        "name": "Cool down - Allow system to stabilize"
      }
    ],
    "processor": "./complex-simulation.js",
    "environments": {
      "development": {
        "target": "http://localhost:8080",
        "variables": {
          "lurkerChance": 40,
          "twitchyChance": 30,
          "heavyHandedChance": 20,
          "bigTickChance": 10
        }
      },
      "production": {
        "target": "https://your-production-url.com",
        "variables": {
          "lurkerChance": 60,
          "twitchyChance": 20,
          "heavyHandedChance": 15,
          "bigTickChance": 5
        }
      },
      "stress": {
        "target": "http://localhost:8080",
        "variables": {
          "lurkerChance": 20,
          "twitchyChance": 30,
          "heavyHandedChance": 30,
          "bigTickChance": 20
        },
        "phases": [
          {
            "duration": 60,
            "arrivalRate": 1,
            "name": "Warm up"
          },
          {
            "duration": 300,
            "arrivalRate": 5,
            "rampTo": 30,
            "name": "Aggressive ramp up"
          },
          {
            "duration": 300,
            "arrivalRate": 30,
            "maxVusers": 100,
            "name": "Stress test"
          },
          {
            "duration": 120,
            "arrivalRate": 1,
            "name": "Cool down"
          }
        ]
      }
    },
    "ensure": {
      "maxErrorRate": 5,
      "max95ResponseTime": 5000
    },
    "plugins": {
      "metrics-by-endpoint": {},
      "expect": {}
    }
  },
  "scenarios": [
    {
      "name": "Mixed User Types",
      "weight": 100,
      "flow": [
        {
          "function": "setupWebSockets"
        },
        {
          "think": 3
        },
        {
          "function": "assignUserType"
        },
        {
          "think": 2
        },
        {
          "function": "checkConnections"
        },
        {
          "function": "simulateUserBehavior"
        },
        {
          "function": "reportStatistics"
        },
        {
          "function": "cleanupConnections"
        }
      ]
    }
  ]
}